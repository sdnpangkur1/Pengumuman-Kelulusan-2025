<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Form Siswa - Kelulusan</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    // Cek login admin
    if (localStorage.getItem("adminLoggedIn") !== "true") {
      window.location.href = "admin-login.html";
    }

    // Ambil data siswa dan editIndex dari localStorage
    const siswaList = JSON.parse(localStorage.getItem("dataSiswa")) || [];
    const editIndex = localStorage.getItem("editIndex");

    // Elemen form
    let inputNama, inputNISN, inputTTL, inputNilai, inputLulus;

    window.onload = () => {
      inputNama = document.getElementById("nama");
      inputNISN = document.getElementById("nisn");
      inputTTL = document.getElementById("ttl");
      inputNilai = document.getElementById("nilai");
      inputLulus = document.getElementById("lulus");

      if (editIndex !== null) {
        // Load data siswa yang diedit
        const data = siswaList[editIndex];
        if (data) {
          inputNama.value = data.nama;
          inputNISN.value = data.nisn;
          inputTTL.value = data.ttl;
          inputNilai.value = data.nilai;
          inputLulus.checked = data.lulus;
        }
      }
    };

    function simpanData() {
      const nama = inputNama.value.trim();
      const nisn = inputNISN.value.trim();
      const ttl = inputTTL.value.trim();
      const nilai = parseFloat(inputNilai.value);
      const lulus = inputLulus.checked;

      if (!nama || !nisn || !ttl || isNaN(nilai)) {
        alert("Mohon isi semua data dengan benar.");
        return;
      }

      const siswaBaru = { nama, nisn, ttl, nilai, lulus };

      if (editIndex !== null) {
        siswaList[editIndex] = siswaBaru;
        localStorage.removeItem("editIndex");
      } else {
        siswaList.push(siswaBaru);
      }

      localStorage.setItem("dataSiswa", JSON.stringify(siswaList));
      alert("Data siswa berhasil disimpan!");
      window.location.href = "admin-dashboard.html";
    }

    function batal() {
      localStorage.removeItem("editIndex");
      window.location.href = "admin-dashboard.html";
    }
  </script>
</head>
<body class="bg-gradient-to-br from-[#0D1B2A] to-[#1B263B] min-h-screen flex items-center justify-center text-white p-6">
  <div class="bg-[#1B263B]/90 p-8 rounded-lg max-w-md w-full shadow-lg">
    <h2 class="text-2xl font-bold text-yellow-400 mb-6 text-center">
      <span id="form-title">Form Data Siswa</span>
    </h2>
    <div class="space-y-4">
      <div>
        <label for="nama" class="block mb-1 font-semibold">Nama Lengkap</label>
        <input
          type="text"
          id="nama"
          placeholder="Masukkan nama lengkap"
          class="w-full px-4 py-2 rounded text-black focus:outline-yellow-400"
        />
      </div>
      <div>
        <label for="nisn" class="block mb-1 font-semibold">NISN</label>
        <input
          type="text"
          id="nisn"
          placeholder="Masukkan NISN"
          class="w-full px-4 py-2 rounded text-black focus:outline-yellow-400"
        />
      </div>
      <div>
        <label for="ttl" class="block mb-1 font-semibold">Tanggal Lahir (DDMMYYYY)</label>
        <input
          type="text"
          id="ttl"
          placeholder="contoh: 15032010"
          class="w-full px-4 py-2 rounded text-black focus:outline-yellow-400"
          maxlength="8"
        />
      </div>
      <div>
        <label for="nilai" class="block mb-1 font-semibold">Nilai Akhir</label>
        <input
          type="number"
          id="nilai"
          placeholder="Masukkan nilai akhir"
          class="w-full px-4 py-2 rounded text-black focus:outline-yellow-400"
          min="0" max="100" step="0.01"
        />
      </div>
      <div class="flex items-center space-x-2">
        <input type="checkbox" id="lulus" />
        <label for="lulus" class="font-semibold">Status Kelulusan (centang jika lulus)</label>
      </div>
    </div>
    <div class="mt-6 flex justify-between">
      <button
        onclick="batal()"
        class="bg-red-600 hover:bg-red-500 px-6 py-2 rounded font-semibold"
      >
        Batal
      </button>
      <button
        onclick="simpanData()"
        class="bg-yellow-400 hover:bg-yellow-300 text-black px-6 py-2 rounded font-semibold"
      >
        Simpan
      </button>
    </div>
  </div>
</body>
</html>